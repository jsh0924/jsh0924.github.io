---
title: ì¼ë³¸ IT Java ì›¹ê°œë°œì ìˆ˜ì—… 39ì¼ì°¨ - DB
date: 2024-05-01 12:00:00
comments: true
categories: [study]
tags: [ê¸€ë¡œë²Œì¸, DB]
render_with_liquid: false
---

## ì‹œí€€ìŠ¤
### ì‹œí€€ìŠ¤ ìƒì„± í˜•ì‹
create sequence ì‹œí€€ìŠ¤ëª…  
- start with n &#10140; ì‹œì‘ ê°’ ì§€ì •  
- increment by n &#10140; ì¦ê°€ ê°’ ì§€ì •  
- maxvalue n &#10140; ìµœëŒ€ê°’ ì§€ì •. ê°’ì„ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ë¬´í•œëŒ€  
- minvalue n &#10140; ìµœì†Œê°’ ì§€ì •. ê°’ì„ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ë¬´í•œì†Œ  
- cycle / nocycle &#10140; ìµœëŒ€ê°’ê¹Œì§€ ì¦ê°€í•˜ê³  ë‹¤ì‹œ ì´ˆê¸°ê°’ìœ¼ë¡œ ì‹œì‘í•  ê²ƒì¸ì§€ ì •í•¨  
- cache n / nocache &#10140; ë©”ëª¨ë¦¬ ìƒì˜ ì‹œí€€ìŠ¤ ê°’ ê´€ë¦¬. ê¸°ë³¸ 20.  
<br>

__currval, nextvalì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²½ìš°__  
1. ì„œë¸Œì¿¼ë¦¬ê°€ ì•„ë‹Œ ê²½ìš°  
2. insert ë¬¸  
3. update ë¬¸  
<br>

__currval, nextvalì„ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ê²½ìš°__  
1. view ì—ì„œ select  
2. distinct í‚¤ì›Œë“œê°€ ìˆëŠ” select  
3. group by, having, order by ì ˆì´ ìˆëŠ” select  
4. select, delete, dupdateì˜ ì„œë¸Œì¿¼ë¦¬  
5. creat table, alter table ëª…ë ¹ì–´  
<br>

### ì‹œí€€ìŠ¤ ë³€ê²½
create sequence ì‹œí€€ìŠ¤ëª…  
- start with n     
- increment by n     
- maxvalue n     
- minvalue n     
- cycle / nocycle     
- cache n / nocache  
<br>
<br>

## JDBC
JDBCë¥¼ ì´ìš©í•œ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°  

1ë‹¨ê³„ : `import java.sql.\*;`  

2ë‹¨ê³„ : íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ ë“œë¼ì´ë¸Œ ê²€ìƒ‰  
		`oracle,jdbc.driver.OracleDriver`  

3ë‹¨ê³„ : ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°  
		`Connection conn = DriverManager.getConnection(url, id, password)`  
		`jdbc:oracle:thin:@localhost:1521:sid(orcl)`  

4ë‹¨ê³„ : ì¿¼ë¦¬ë¬¸ ì‘ì„±  
		`1. Statement stme = conn.createStatement(); // ì •ì `  
		`2. PreparedStatement pstmt = prepareStatement(query); // ë™ì `  

5ë‹¨ê³„ : ê²°ê³¼ ì €ì¥  
ì •ì ì¼ ë•Œ  
`ResultSet rs = stmt.executeQuery(query); // select (ì¡°íšŒ, ê²€ìƒ‰)`  
`ResultSet rs = stmt.executeUpdate(query); // insert, update, delete`  

ë™ì ì¼ ë•Œ  
`ResultSet rs = pstmt.executeQuery(query); // select (ì¡°íšŒ, ê²€ìƒ‰)`  
`ResultSet rs = pstmt.executeUpdate(query); // insert, update, delete`  

6ë‹¨ê³„ : ì‘ì—…ì´ ë‹¤ ëë‚œ í›„ ë°˜ë“œì‹œ `close()`  

ì‹¤í–‰í•˜ê³ ì í•˜ëŠ” sqlë¬¸ì´ select ì¿¼ë¦¬ì¸ ê²½ìš° ì¿¼ë¦¬ì˜ ì‹¤í–‰ ê²°ê³¼ì˜ ì§‘í•©ì„ ë¦¬í„´ë°›ì„ ìˆ˜ ìˆëŠ” `executeQuery()` ë©”ì†Œë“œë¥¼ ì‚¬ìš©  
<br>

## ResultSet
select ì¿¼ë¦¬ì˜ ìˆ˜í–‰ ê²°ê³¼ë¡œ ì–»ì–´ì§„ ê²°ê³¼ ì§‘í•©ì„ ì¶”ìƒí™”í•œ ê²ƒ  
ê²°ê³¼ ì§‘í•©ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ë©”ì†Œë“œì™€ ì»¤ì„œë¥¼ í¬í•¨í•œë‹¤.  

## PreparedStatement
ë°”ì¸ë”© ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•´, sqlì˜ í˜•íƒœëŠ” ë™ì¼í•˜ì§€ë§Œ ì¡°ê±´ì´ë‚˜ ë³€ìˆ˜ê°’ì´ ë‹¤ë¥¸ ë¬¸ì¥ì„ ë³€ìˆ˜ì²˜ë¦¬í•˜ì—¬ í•­ìƒ ë™ì¼í•œ sqlë¬¸ì„ ìˆ˜í–‰í•˜ë„ë¡ ì²˜ë¦¬  

### PreparedStatement ê°ì²´ì˜ ìƒì„±ê³¼ ë°”ì¸ë”© ë³€ìˆ˜ì˜ ì‚¬ìš© ë°©ë²•
PreparedStatementì˜ ë°”ì¸ë”© ë³€ìˆ˜ ê°’ì„ ì£¼ëŠ” setXXX()ê°’ì„ ì œê³µí•œë‹¤.  

`String sql = "insert into department values(?, ?, ?, ?)";`  
`PreparedStatement pstmt = conn.preparedStatement(sql); // ë™ì `  
<pre>
	ë°”ì¸ë”© ë³€ìˆ˜ì˜ ê°œìˆ˜ë§Œí¼ ìˆœì„œëŒ€ë¡œ í•´ë‹¹ ë³€ìˆ˜ì— ëŒ€ì²´ë  ê°’ì„ ì§€ì •í•´ì£¼ë©´ ëœë‹¤.
</pre>

`pstmt.setInt(1, 203);`  
`pstmt.setString(2, "ì»´í“¨í„°ê³µí•™ê³¼");`  
`pstmt.setInt(3, 200);`  
`pstmt.setString(4, "7í˜¸ê´€");`  

ë°”ì¸ë”© ë³€ìˆ˜ëŠ” ì»¬ëŸ¼ëª…ì— ì ˆëŒ€ ì‚¬ìš© ë¶ˆê°€  

## ì‹¤ìŠµ
#### SQL
````sql
create table emp01
as select * from emp;

create table dept01
as select * from dept;

select constraint_name, constraint_type, table_name, r_constraint_name,
status from user_constraints where table_name in('EMP01', 'DEPT01');

create view view_emp_dept
as
select e.empno, e.ename, e.sal, e.deptno, d.dname, d.loc from emp e, dept d -- ì„œë¸Œì¿¼ë¦¬
where e.deptno = d.deptno order by empno desc;

select * from view_emp_dept;

select view_name, text from user_views;

-- ë·° ì‚­ì œ
drop view view_sal;

-- ë·° ìˆ˜ì •ì„ ìœ„í•œ or replace ì˜µì…˜
create or replace view view_emp_dept
as
select empno, ename, sal, deptno from emp01 where deptno = 10;

select * from tab;

create or replace force view view_notable
as
select empno, ename, deptno from emp02 where deptno = 10;

select * from view_notable;
insert into view view_notable values(4587, 'aaaa', 20);

create or replace view view_chk20
as
select empno, ename, sal, deptno from emp01 where deptno = 20 with check option; -- ë¶€ì„œë²ˆí˜¸ ë³€ê²½ ë¶ˆê°€

update view_chk20 set deptno = 10 where sal >= 5000;
select * from ciew_chk20;

create or replace view view_read30
as
select empno, ename, sal, comm, deptno from emp01 where deptno = 30 with read only;

update view_read30 set comm = 1000;

create or replace view view_hire
as
select empno, ename, hiredate from emp01 order by hiredate;
select rownum, empno, ename, hiredate from view_hire where rownum <= 5;


select * from emp02;

create table emp02
as
select empno, ename, hiredate from emp where 1 = 0; -- ë°ì´í„° ì—†ì´ êµ¬ì¡°ë§Œ ê°€ì ¸ì˜´
select * from emp02;

create sequence emp_seq start with 1
increment by 1
maxvalue 1000000;

desc user_sequences;

insert into emp02 values(emp_seq.nextval, 'ê°€ê¸¸ë™', sysdate);
insert into emp02 values(emp_seq.nextval, 'ë‚˜ê¸¸ë™', sysdate);
insert into emp02 values(emp_seq.nextval, 'ë‹¤ê¸¸ë™', sysdate);
select emp_seq.currval from dual;
select emp__seq.nextval from dual; -- ë‹¤ìŒê°’


create sequence dept_seq start with 10
increment by 10
maxvalue 30;

-- ì‹œí€€ìŠ¤ ê°’ ë³€ê²½
alter sequence dept_seq
maxvalue 1000000;

-- ì‹œí€€ìŠ¤ ì‚­ì œ
drop sequence dept_seq;
drop table dept02;
select * from dept02;

create table dept02
as select * from dept where 1 = 0;

delete from dept02;
insert into dept02 values(dept_seq.nextval, 'ACCOUNTING', 'NEW YORK');
insert into dept02 values(dept_seq.nextval, 'RESEARCH', 'DALLAS');
insert into dept02 values(dept_seq.nextval, 'SALES', 'CHICAGO');
insert into dept02 values(dept_seq.nextval, 'OPERATIONS', 'BOSTON');

select * from tab;
purge recyclebin;
````
<br>

#### JAVA
##### JdbcEx01.java
````java
package dbex;

import java.sql.*;

public class JdbcEx01 {

	public static void main(String[] args) {
		
		Connection conn = null;
		Statement stmt = null;
		
		try {
			// jdbc ë“œë¼ì´ë¸Œ ë©”ëª¨ë¦¬ì— ë¡œë“œ
			Class.forName("oracle.jdbc.driver.OracleDriver"); // 2ë‹¨ê³„
			
			// ì—°ê²°ê°ì²´ ìƒì„±
			conn = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:orcl", "scott", "tiger"); // DBì—°ê²°!!!!!
			System.out.println("...ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„±ê³µ...");
			
			// Statement ê°ì²´ ìƒì„±
			stmt = conn.createStatement();
			
			// SQL ì¿¼ë¦¬ë¬¸ ì‘ì„±
			String sql = "insert into department values(203, 'ì œì–´ê³„ì¸¡ê³µí•™ê³¼', 200, '7í˜¸ê´€')";
			int result = stmt.executeUpdate(sql);
			
			System.out.println(result + "ê°œì˜ í–‰ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.");
			
		} catch(ClassNotFoundException ce) {
			ce.printStackTrace();
		} catch(SQLException s) {
			s.printStackTrace();
			
		} finally { // ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í•´ì œ ë° ë‹«ê¸°
			try {
				if (stmt != null) {
					stmt.close();
				}
				
			} catch(SQLException se) {
				se.printStackTrace();
			}
			
			try {
				if (conn != null) {
					conn.close();
				}
				
			} catch(SQLException se) {
				se.printStackTrace();
			}
			
		}
	}

}

````
<br>

##### JdbcEx02.java
````java
package dbex;

import java.sql.*;

public class JdbcEx02 {

	public static void main(String[] args) {
		
		Connection conn = null;
		Statement stmt = null;
		
		try {
			// jdbc ë“œë¼ì´ë¸Œ ë©”ëª¨ë¦¬ì— ë¡œë“œ
			Class.forName("oracle.jdbc.driver.OracleDriver"); // 2ë‹¨ê³„
			
			// ì—°ê²°ê°ì²´ ìƒì„±
			conn = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:orcl", "scott", "tiger"); // DBì—°ê²°!!!!!
			System.out.println("...ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„±ê³µ...");
			
			// Statement ê°ì²´ ìƒì„±
			stmt = conn.createStatement();
			
			// SQL ì¿¼ë¦¬ë¬¸ ì‘ì„±
			String sql = "update department set dname = 'ì»´í“¨í„°ê³µí•™ê³¼' where deptno = 203";
			int result = stmt.executeUpdate(sql);
			
			System.out.println(result + "ê°œì˜ í–‰ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
			
		} catch(ClassNotFoundException ce) {
			ce.printStackTrace();
		} catch(SQLException s) {
			s.printStackTrace();
			
		} finally { // ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í•´ì œ ë° ë‹«ê¸°
			try {
				if (stmt != null) {
					stmt.close();
				}
				
			} catch(SQLException se) {
				se.printStackTrace();
			}
			
			try {
				if (conn != null) {
					conn.close();
				}
				
			} catch(SQLException se) {
				se.printStackTrace();
			}
			
		}
	}

}

````
<br>

##### JdbcEx03.java
````java
package dbex;

import java.sql.*;

public class JdbcEx03 {

	public static void main(String[] args) {
		
		Connection conn = null;
		Statement stmt = null;
		
		try {
			// jdbc ë“œë¼ì´ë¸Œ ë©”ëª¨ë¦¬ì— ë¡œë“œ
			Class.forName("oracle.jdbc.driver.OracleDriver"); // 2ë‹¨ê³„
			
			// ì—°ê²°ê°ì²´ ìƒì„±
			conn = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:orcl", "scott", "tiger"); // DBì—°ê²°!!!!!
			System.out.println("...ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„±ê³µ...");
			
			// Statement ê°ì²´ ìƒì„±
			stmt = conn.createStatement();
			
			// SQL ì¿¼ë¦¬ë¬¸ ì‘ì„±
			String sql = "delete from department where dname = 'ì»´í“¨í„°ê³µí•™ê³¼'";
			int result = stmt.executeUpdate(sql);
			
			System.out.println(result + "ê°œì˜ í–‰ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
			
		} catch(ClassNotFoundException ce) {
			ce.printStackTrace();
		} catch(SQLException s) {
			s.printStackTrace();
			
		} finally { // ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í•´ì œ ë° ë‹«ê¸°
			try {
				if (stmt != null) {
					stmt.close();
				}
				
			} catch(SQLException se) {
				se.printStackTrace();
			}
			
			try {
				if (conn != null) {
					conn.close();
				}
				
			} catch(SQLException se) {
				se.printStackTrace();
			}
			
		}
	}

}

````
<br>

##### JdbcEx04.java
````java
package dbex;

import java.sql.*;

public class JdbcEx04 {

	public static void main(String[] args) {
		
		Connection conn = null;
		Statement stmt = null;
		ResultSet rs = null;
		
		try {
			// jdbc ë“œë¼ì´ë¸Œ ë©”ëª¨ë¦¬ì— ë¡œë“œ
			Class.forName("oracle.jdbc.driver.OracleDriver"); // 2ë‹¨ê³„
			
			// ì—°ê²°ê°ì²´ ìƒì„±
			conn = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:orcl", "scott", "tiger"); // DBì—°ê²°!!!!!
			System.out.println("...ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„±ê³µ...");
			
			// Statement ê°ì²´ ìƒì„±
			stmt = conn.createStatement();
			
			// SQL ì¿¼ë¦¬ë¬¸ ì‘ì„±
			String sql = "select deptno, dname, college, loc from department";
			rs = stmt.executeQuery(sql); // rsê°ì²´ë¡œë¶€í„° ë°ì´í„° ì¶”ì¶œ
			// rsê°ì²´ì˜ next() ë©”ì†Œë“œë¥¼ í†µí•´ ì»¤ì„œë¥¼ ë‹¤ìŒìœ¼ë¡œ ì´ë™ì‹œí‚¤ë©°, í–‰ì´ ì¡´ì¬í•˜ë©´ true, ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ false ë°˜í™˜
			
			while(rs.next()) {
				// ì»¤ì„œê°€ ìœ„ì¹˜í•œ í–‰ì˜ ê°ê°ì˜ ì»¬ëŸ¼ì—ì„œ ê°’ ì¶”ì¶œ
				// ê°’ì„ ì¶”ì¶œí•  ë•Œ getXXX(ì»¬ëŸ¼ ìœ„ì¹˜), getXXX(ì»¬ëŸ¼ëª…) ë©”ì†Œë“œ ì´ìš©
				
				int i = rs.getInt(1); // == rs.getInt("deptno);
				String s1 = rs.getString(2); // == rs.getString("dname");
				int j = rs.getInt(3); // == rs.getInt("college");
				String s2 = rs.getString(4); // == rs.getString("loc");
				System.out.println(i + "\t" + s1 + "\t" + j + "\t" + s2 + "\t");
			}
			
		} catch(ClassNotFoundException ce) {
			ce.printStackTrace();
		} catch(SQLException s) {
			s.printStackTrace();
			
		} finally { // ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í•´ì œ ë° ë‹«ê¸°
			try {
				if (rs != null) {
					rs.close();
				}
				
			} catch(SQLException se) {
				se.printStackTrace();
			}
			
			try {
				if (stmt != null) {
					stmt.close();
				}
				
			} catch(SQLException se) {
				se.printStackTrace();
			}
			
			try {
				if (conn != null) {
					conn.close();
				}
				
			} catch(SQLException se) {
				se.printStackTrace();
			}
			
		}
	}

}

````
<br>
<br>
- - -
<br>
<br>
ã…‹â«¬ã…‹â«¬ã…‹â«¬ã…‹â«¬ã…‹â«¬ã…‹â«¬ã…‹â«¬ã…‹â«¬ã…‹â«¬ã…‹â«¬ã…‹â«¬ã…‹â«¬ã…‹â«¬ã…‹â«¬ã…‹â«¬ã…‹â«¬ã…‹â«¬ğŸ˜‚  
í•˜ë‚˜ë„ ëª¨ë¥´ê² ì–´ìš”~~~~ í°ì¼ë‚¬ë‹¤~~~~  
ì˜¤ëŠ˜ì€ ê¼­ ê¼­ ê²Œì„ í•˜ê³  ì¸ê°• ë“£ê¸°ë¡œ!!!!!ğŸ˜¡ğŸ˜¡  

